<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FishMart | Shopping Cart</title>

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:"Segoe UI",sans-serif;
}

body{
    background:
        radial-gradient(circle at 20% 50%, rgba(15, 244, 211, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(30, 144, 255, 0.1) 0%, transparent 50%),
        linear-gradient(135deg, #001a4d 0%, #004d7a 25%, #0080b3 50%, #00a3e6 75%, #1a5f7a 100%);
    background-attachment: fixed;
    color:#e2e8f0;
    min-height:100vh;
    position: relative;
    overflow-x: hidden;
}

body::before {
    content: '';
    position: fixed;
    bottom: 0;
    left: 0;
    width: 200%;
    height: 100px;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M0,50 Q300,0 600,50 T1200,50 L1200,120 L0,120 Z" fill="%230080b3" opacity="0.3"></path><path d="M0,60 Q300,40 600,60 T1200,60 L1200,120 L0,120 Z" fill="%2300a3e6" opacity="0.5"></path><path d="M0,70 Q300,50 600,70 T1200,70 L1200,120 L0,120 Z" fill="%2315aabf" opacity="0.7"></path></svg>') repeat-x;
    background-size: 600px 120px;
    animation: wave 15s linear infinite;
    z-index: 1;
    pointer-events: none;
}

@keyframes wave {
    0% {
        transform: translateX(0);
    }
    100% {
        transform: translateX(600px);
    }
}

/* HEADER */
.header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:20px 60px;
    background:linear-gradient(135deg, #001a4d 0%, #003d7a 100%);
    border-bottom:3px solid #00d4ff;
    box-shadow: 0 4px 15px rgba(0, 180, 216, 0.3);
    position: relative;
    z-index: 10;
}

.logo{
    font-size:28px;
    font-weight:bold;
    color:#00ffff;
    text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
}

.header-right{
    display:flex;
    gap:20px;
    align-items:center;
}

.back-button{
    background:linear-gradient(135deg, #0080b3, #00d4ff);
    color:#000;
    border:none;
    padding:8px 16px;
    border-radius:20px;
    cursor:pointer;
    font-weight:bold;
    transition: 0.3s;
    box-shadow: 0 2px 8px rgba(0, 212, 255, 0.3);
    text-decoration:none;
    display:inline-block;
}

.back-button:hover {
    background:linear-gradient(135deg, #00d4ff, #00ffff);
    box-shadow: 0 4px 12px rgba(0, 255, 255, 0.5);
}

.logout{
    background:linear-gradient(135deg, #0080b3, #00d4ff);
    color:#000;
    border:none;
    padding:8px 16px;
    border-radius:20px;
    cursor:pointer;
    font-weight:bold;
    transition: 0.3s;
    box-shadow: 0 2px 8px rgba(0, 212, 255, 0.3);
}

.logout:hover {
    background:linear-gradient(135deg, #00d4ff, #00ffff);
    box-shadow: 0 4px 12px rgba(0, 255, 255, 0.5);
}

/* MESSAGES */
.messages{
    padding:20px 60px;
    position: relative;
    z-index: 2;
}

.alert{
    padding:15px;
    border-radius:10px;
    margin-bottom:10px;
    border-left:4px solid;
}

.alert-success{
    background:linear-gradient(135deg, rgba(0, 180, 216, 0.2), rgba(0, 212, 255, 0.2));
    color:#00ffff;
    border-color:#00d4ff;
    box-shadow: 0 4px 12px rgba(0, 212, 255, 0.2);
}

.alert-error{
    background:linear-gradient(135deg, rgba(255, 107, 107, 0.2), rgba(255, 82, 82, 0.2));
    color:#ff8787;
    border-color:#ff6b6b;
    box-shadow: 0 4px 12px rgba(255, 107, 107, 0.2);
}

/* MAIN CONTAINER */
.container{
    padding:40px 60px;
    position: relative;
    z-index: 2;
}

.page-title{
    font-size:32px;
    font-weight:bold;
    color:#00ffff;
    text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
    margin-bottom:30px;
}

/* CART SECTION */
.cart-section{
    background:rgba(0, 51, 102, 0.6);
    padding:30px;
    border-radius:15px;
    border:2px solid #00d4ff;
    margin-bottom:30px;
    box-shadow: 0 8px 32px rgba(0, 212, 255, 0.2);
    backdrop-filter: blur(10px);
}

.cart-section h2{
    color:#00ffff;
    margin-bottom:20px;
    text-shadow: 0 0 8px rgba(0, 255, 255, 0.5);
}

.cart-empty{
    text-align:center;
    padding:60px 20px;
    color:#94a3b8;
}

.cart-empty-icon{
    font-size:64px;
    margin-bottom:20px;
}

.cart-empty p{
    margin:10px 0;
}

.cart-items{
    margin-bottom:20px;
}

.cart-item{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:15px;
    background:rgba(0, 212, 255, 0.1);
    border-radius:8px;
    margin-bottom:10px;
    border-left:3px solid #00d4ff;
    transition: 0.3s;
}

.cart-item:hover {
    background:rgba(0, 212, 255, 0.15);
    box-shadow: 0 4px 15px rgba(0, 212, 255, 0.2);
}

.cart-item-info{
    flex:1;
}

.cart-item-name{
    font-weight:bold;
    color:#e0f2fe;
    margin-bottom:5px;
}

.cart-item-details{
    font-size:13px;
    color:#94a3b8;
}

.cart-item-price{
    font-size:18px;
    font-weight:bold;
    color:#00ffff;
    margin-right:20px;
}

.cart-item-remove{
    background:linear-gradient(135deg, #ff6b6b, #ff5252);
    color:white;
    border:none;
    padding:8px 12px;
    border-radius:6px;
    cursor:pointer;
    font-size:12px;
    transition: 0.3s;
}

.cart-item-remove:hover {
    box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
}

.cart-summary{
    background:rgba(0, 212, 255, 0.15);
    padding:15px;
    border-radius:8px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:20px;
    border:2px solid #00d4ff;
}

.cart-total{
    font-size:24px;
    font-weight:bold;
    color:#00ffff;
}

/* FORM STYLES */
.order-form{
    background:rgba(0, 51, 102, 0.6);
    padding:30px;
    border-radius:15px;
    border:2px solid #00d4ff;
    box-shadow: 0 8px 32px rgba(0, 212, 255, 0.2);
    backdrop-filter: blur(10px);
}

.form-row{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:20px;
    margin-bottom:20px;
}

.form-row.full{
    grid-template-columns: 1fr;
}

.form-group{
    display:flex;
    flex-direction:column;
}

.form-group label{
    color:#38bdf8;
    margin-bottom:8px;
    font-weight:bold;
}

.form-group input,
.form-group select,
.form-group textarea{
    padding:12px;
    border-radius:8px;
    border:2px solid #00b4d8;
    background:rgba(0, 26, 77, 0.8);
    color:#e2e8f0;
    outline:none;
    transition: 0.3s;
    font-family:"Segoe UI",sans-serif;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus{
    border-color:#00ffff;
    box-shadow: 0 0 10px rgba(0, 255, 255, 0.4);
}

.form-group textarea{
    resize:vertical;
    min-height:100px;
}

.checkout-btn{
    width:100%;
    padding:15px;
    background:linear-gradient(135deg, #10b981 0%, #059669 100%);
    color:white;
    border:none;
    border-radius:8px;
    font-size:16px;
    font-weight:bold;
    cursor:pointer;
    transition:0.3s;
    box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
}

.checkout-btn:hover{
    background:linear-gradient(135deg, #059669 0%, #047857 100%);
    box-shadow: 0 6px 20px rgba(16, 185, 129, 0.5);
}

.order-form h3{
    color:#38bdf8;
    margin-bottom:15px;
    margin-top:25px;
}

.order-form h3:first-child{
    margin-top:0;
}

/* RESPONSIVE */
@media (max-width:768px){
    .header{
        padding:15px 30px;
    }
    
    .container{
        padding:20px 30px;
    }
    
    .form-row{
        grid-template-columns: 1fr;
    }
    
    .cart-item{
        flex-direction:column;
        align-items:flex-start;
    }
    
    .cart-item-price{
        margin-right:0;
        margin-bottom:10px;
    }
    
    .cart-summary{
        flex-direction:column;
        gap:10px;
        text-align:center;
    }
}

/* SECTION TITLES */
.section-title{
    color:#00ffff;
    font-size:20px;
    font-weight:bold;
    margin-bottom:15px;
    text-shadow: 0 0 8px rgba(0, 255, 255, 0.5);
}
</style>

</head>
<body>

<!-- HEADER -->
<div class="header">
    <div class="logo">üê† FishMart</div>
    <div class="header-right">
        <a href="/cdashboard/" class="back-button">‚Üê Back to Dashboard</a>
        <form action="/logout/" method="post" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="logout">üö™ Logout</button>
        </form>
    </div>
</div>

<!-- MESSAGES -->
<div class="messages">
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{% if message.tags %}{{ message.tags }}{% else %}info{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
</div>

<!-- MAIN CONTAINER -->
<div class="container">
    <div class="page-title">üõí Shopping Cart</div>

    <!-- CART ITEMS SECTION -->
    {% if cart %}
    <div class="cart-section">
        <div class="cart-items">
            {% for item in cart %}
            <div class="cart-item">
                <div class="cart-item-info">
                    <div class="cart-item-name">{{ item.fish_name }}</div>
                    <div class="cart-item-details">
                        Quantity: {{ item.quantity }} KG √ó ‚Çπ{{ item.price }}/KG
                        <br>
                        Seller: {{ item.seller_name }}
                    </div>
                </div>
                <div class="cart-item-price">‚Çπ {{ item.subtotal }}</div>
                <form method="post" action="/cart/remove/{{ forloop.counter0 }}/" style="margin:0;">
                    {% csrf_token %}
                    <button type="submit" class="cart-item-remove">Remove</button>
                </form>
            </div>
            {% endfor %}
        </div>

        <div class="cart-summary">
            <span style="color:#94a3b8;">Total Cart Amount:</span>
            <div class="cart-total">‚Çπ {{ cart_total }}</div>
        </div>
    </div>

    <!-- ORDER FORM SECTION -->
    <form method="post" action="/order/place/" class="order-form">
        {% csrf_token %}
        <h3 style="margin-bottom:20px;color:#38bdf8;">üìã Order Details</h3>
        
        <div class="form-row">
            <div class="form-group">
                <label>Full Name</label>
                <input type="text" name="customer_name" required placeholder="Enter your name">
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="email" name="customer_email" required placeholder="Enter your email">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Phone Number</label>
                <input type="text" name="customer_phone" required placeholder="Enter your phone">
            </div>
            <div class="form-group">
                <label>Payment Method</label>
                <select name="payment_method" required id="payment-method">
                    <option value="cash_on_delivery">üíµ Cash on Delivery (COD)</option>
                    <option value="upi">üì± UPI Payment</option>
                    <option value="bank_transfer">üè¶ Bank Transfer</option>
                </select>
            </div>
        </div>

        <!-- UPI PAYMENT SECTION -->
        <div id="upi-section" style="display:none;">
            <h3 style="margin-top:20px;margin-bottom:15px;color:#38bdf8;">üì± UPI Payment Details</h3>
            <div class="form-row">
                <div class="form-group">
                    <label>UPI ID</label>
                    <input type="text" name="upi_id" placeholder="Enter your UPI ID (e.g., yourname@upi)">
                </div>
                <div class="form-group">
                    <label>Confirm UPI ID</label>
                    <input type="text" name="upi_id_confirm" placeholder="Confirm your UPI ID">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>UPI Payment Reference/Transaction ID (After Payment)</label>
                    <input type="text" name="upi_transaction_id" placeholder="Enter UPI transaction reference ID">
                </div>
            </div>
        </div>

        <!-- BANK TRANSFER SECTION -->
        <div id="bank-section" style="display:none;">
            <h3 style="margin-top:20px;margin-bottom:15px;color:#38bdf8;">üè¶ Bank Transfer Details</h3>
            <div class="form-row">
                <div class="form-group">
                    <label>Account Holder Name</label>
                    <input type="text" name="bank_account_name" placeholder="Enter account holder name">
                </div>
                <div class="form-group">
                    <label>Bank Name</label>
                    <input type="text" name="bank_name" placeholder="Enter bank name (e.g., HDFC, ICICI)">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>Account Number</label>
                    <input type="text" name="bank_account_number" placeholder="Enter your account number">
                </div>
                <div class="form-group">
                    <label>Confirm Account Number</label>
                    <input type="text" name="bank_account_number_confirm" placeholder="Confirm your account number">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>IFSC Code</label>
                    <input type="text" name="bank_ifsc_code" placeholder="Enter IFSC code">
                </div>
                <div class="form-group">
                    <label>Branch Name</label>
                    <input type="text" name="bank_branch" placeholder="Enter branch name">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>Bank Transfer Reference/Cheque No (After Transfer)</label>
                    <input type="text" name="bank_reference_id" placeholder="Enter bank reference or cheque number">
                </div>
            </div>
        </div>

        <h3 style="margin-top:25px;margin-bottom:15px;color:#38bdf8;">üìç Delivery Location</h3>
        
        <div class="form-row">
            <div class="form-group">
                <label>State</label>
                <select name="delivery_state" required>
                    <option value="">Select State</option>
                    <option value="Tamil Nadu">Tamil Nadu</option>
                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                    <option value="Karnataka">Karnataka</option>
                    <option value="Kerala">Kerala</option>
                    <option value="Maharashtra">Maharashtra</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label>District</label>
                <select name="delivery_city" required id="district-select">
                    <option value="">Select District</option>
                    <!-- Tamil Nadu Districts -->
                    <option value="Ariyalur" class="tn-district">Ariyalur</option>
                    <option value="Chengalpattu" class="tn-district">Chengalpattu</option>
                    <option value="Chennai" class="tn-district">Chennai</option>
                    <option value="Coimbatore" class="tn-district">Coimbatore</option>
                    <option value="Cuddalore" class="tn-district">Cuddalore</option>
                    <option value="Dharmapuri" class="tn-district">Dharmapuri</option>
                    <option value="Dindigul" class="tn-district">Dindigul</option>
                    <option value="Erode" class="tn-district">Erode</option>
                    <option value="Kallakurichi" class="tn-district">Kallakurichi</option>
                    <option value="Kancheepuram" class="tn-district">Kancheepuram</option>
                    <option value="Kanniyakumari" class="tn-district">Kanniyakumari</option>
                    <option value="Karur" class="tn-district">Karur</option>
                    <option value="Krishnagiri" class="tn-district">Krishnagiri</option>
                    <option value="Madurai" class="tn-district">Madurai</option>
                    <option value="Mayiladuthurai" class="tn-district">Mayiladuthurai</option>
                    <option value="Nagapattinam" class="tn-district">Nagapattinam</option>
                    <option value="Namakkal" class="tn-district">Namakkal</option>
                    <option value="Nilgiris" class="tn-district">Nilgiris</option>
                    <option value="Perambalur" class="tn-district">Perambalur</option>
                    <option value="Puducherry" class="tn-district">Puducherry</option>
                    <option value="Pudukkottai" class="tn-district">Pudukkottai</option>
                    <option value="Ramanathapuram" class="tn-district">Ramanathapuram</option>
                    <option value="Ranipet" class="tn-district">Ranipet</option>
                    <option value="Salem" class="tn-district">Salem</option>
                    <option value="Sivaganga" class="tn-district">Sivaganga</option>
                    <option value="Tenkasi" class="tn-district">Tenkasi</option>
                    <option value="Thanjavur" class="tn-district">Thanjavur</option>
                    <option value="Theni" class="tn-district">Theni</option>
                    <option value="Thiruvallur" class="tn-district">Thiruvallur</option>
                    <option value="Thiruvannamalai" class="tn-district">Thiruvannamalai</option>
                    <option value="Thirupathur" class="tn-district">Thirupathur</option>
                    <option value="Tiruppur" class="tn-district">Tiruppur</option>
                    <option value="Tiruvannamalai" class="tn-district">Tiruvannamalai</option>
                    <option value="Trichirappalli" class="tn-district">Trichirappalli</option>
                    <option value="Vellore" class="tn-district">Vellore</option>
                    <option value="Villupuram" class="tn-district">Villupuram</option>
                    <option value="Virudunagar" class="tn-district">Virudunagar</option>
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>City</label>
                <input type="text" name="delivery_district" required placeholder="Enter city name">
            </div>
            <div class="form-group">
                <label>Village/Area</label>
                <input type="text" name="delivery_village" required placeholder="Enter village or area name">
            </div>
        </div>

        <div class="form-row full">
            <div class="form-group">
                <label>Special Instructions (Optional)</label>
                <textarea name="notes" placeholder="Any special requests or delivery instructions..."></textarea>
            </div>
        </div>

        <button type="submit" class="checkout-btn">‚úì Place Order (‚Çπ {{ cart_total }})</button>
    </form>

    {% else %}
    <div class="cart-section">
        <div class="cart-empty">
            <div class="cart-empty-icon">üõí</div>
            <p style="font-size:18px;font-weight:bold;">Your cart is empty!</p>
            <p style="font-size:13px;margin-top:10px;">Add some fresh fish products to get started</p>
            <a href="/cdashboard/" style="display:inline-block;margin-top:20px;padding:10px 20px;background:linear-gradient(135deg, #0080b3, #00d4ff);color:white;border-radius:6px;text-decoration:none;font-weight:bold;transition:0.3s;">‚Üê Return to Dashboard</a>
        </div>
    </div>
    {% endif %}

</div>

<!-- JAVASCRIPT FOR PAYMENT METHOD -->
<script>
document.getElementById('payment-method').addEventListener('change', function(){
    const upiSection = document.getElementById('upi-section');
    const bankSection = document.getElementById('bank-section');
    
    if(this.value === 'upi'){
        upiSection.style.display = 'block';
        bankSection.style.display = 'none';
    } else if(this.value === 'bank_transfer'){
        upiSection.style.display = 'none';
        bankSection.style.display = 'block';
    } else {
        upiSection.style.display = 'none';
        bankSection.style.display = 'none';
    }
});
</script>

</body>
</html>
