<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commission Details - FishMart Admin</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
       body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    min-height: 100vh;
    padding: 20px;

    /* SEA THEME */
    background:
        radial-gradient(circle at top, #e0f7fa 0%, transparent 45%),
        linear-gradient(
            135deg,
            #01579b 0%,
            #0288d1 40%,
            #4fc3f7 70%,
            #b3e5fc 100%
        );

    background-attachment: fixed;
}

        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .commission-formula {
            background: #f0f4ff;
            padding: 15px;
            border-left: 4px solid #667eea;
            border-radius: 5px;
            margin-top: 15px;
            font-size: 14px;
            color: #555;
        }
        
        .commission-formula strong {
            color: #667eea;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .stat-card h3 {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .stat-card .value {
            font-size: 28px;
            font-weight: bold;
        }
        
        .stat-card .subtext {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .filters-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .filters-section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 18px;
        }
        
        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
        }
        
        .filter-group label {
            color: #555;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .filter-group select {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .filter-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .filter-buttons {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }
        
        .btn-secondary:hover {
            background: #e0e0e0;
        }
        
        .table-section {
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .table-wrapper {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        thead {
            background: #f8f9fa;
            border-bottom: 2px solid #ddd;
        }
        
        th {
            padding: 15px;
            text-align: left;
            color: #333;
            font-weight: 600;
            font-size: 13px;
            white-space: nowrap;
        }
        
        td {
            padding: 15px;
            border-bottom: 1px solid #eee;
            color: #555;
            font-size: 14px;
        }
        
        tbody tr:hover {
            background: #f8f9fa;
        }
        
        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-accepted {
            background: #d4edda;
            color: #155724;
        }
        
        .status-delivered {
            background: #cfe2ff;
            color: #084298;
        }
        
        .status-rejected {
            background: #f8d7da;
            color: #842029;
        }
        
        .amount-positive {
            color: #28a745;
            font-weight: 600;
        }
        
        .amount-commission {
            color: #dc3545;
            font-weight: 600;
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            color: #999;
            font-size: 16px;
        }
        
        .commission-breakdown {
            background: #f0f4ff;
            padding: 10px 12px;
            border-radius: 5px;
            font-size: 12px;
            color: #555;
            font-weight: 500;
        }
        
        .summary-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .summary-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }
        
        .summary-item {
            border-left: 4px solid #667eea;
            padding-left: 15px;
        }
        
        .summary-item label {
            display: block;
            color: #999;
            font-size: 12px;
            margin-bottom: 5px;
        }
        
        .summary-item .value {
            color: #333;
            font-size: 20px;
            font-weight: bold;
        }
        
        .page-title {
            color: white;
            margin-bottom: 20px;
            font-size: 32px;
            font-weight: bold;
        }
        
        .breadcrumb {
            color: rgba(255,255,255,0.8);
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .breadcrumb a {
            color: white;
            text-decoration: none;
            margin-right: 10px;
        }
        
        .breadcrumb a:hover {
            text-decoration: underline;
        }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .filter-row {
                grid-template-columns: 1fr;
            }
            
            table {
                font-size: 12px;
            }
            
            th, td {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="breadcrumb">
            <a href="/superadmin/dashboard/">Dashboard</a> / Commission Details
        </div>
        
        <h1 class="page-title">üí∞ Commission Details & Breakdown</h1>
        
        <div class="header">
            <h2>Commission Formula: 5% on Total Order Value</h2>
            <div class="commission-formula">
                <strong>Example:</strong> If seller sells 1kg fish at ‚Çπ100/kg<br>
                ‚úì Total Price = ‚Çπ100 (1kg √ó ‚Çπ100)<br>
                ‚úì 5% Commission = ‚Çπ5 (‚Çπ100 √ó 5%)<br>
                ‚úì Seller Gets = ‚Çπ95 (‚Çπ100 - ‚Çπ5)<br><br>
                <strong>For Multiple KG:</strong> If 5kg fish at ‚Çπ100/kg = ‚Çπ500 total ‚Üí ‚Çπ25 commission ‚Üí Seller gets ‚Çπ475
            </div>
        </div>
        
        <!-- Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3>Total Commission (5%)</h3>
                <div class="value">‚Çπ{{ total_commission|floatformat:2 }}</div>
                <div class="subtext">Platform earnings</div>
            </div>
            <div class="stat-card">
                <h3>Total Fish Sold (KG)</h3>
                <div class="value">{{ total_kg|floatformat:2 }}</div>
                <div class="subtext">kg</div>
            </div>
            <div class="stat-card">
                <h3>Total Sales Value</h3>
                <div class="value">‚Çπ{{ total_sales|floatformat:2 }}</div>
                <div class="subtext">All orders combined</div>
            </div>
            <div class="stat-card">
                <h3>Avg Commission/Order</h3>
                <div class="value">‚Çπ{{ avg_commission|floatformat:2 }}</div>
                <div class="subtext">{{ orders|length }} orders</div>
            </div>
        </div>
        
        <!-- Filters -->
        <div class="filters-section">
            <h2>üîç Filters</h2>
            <form method="get">
                <div class="filter-row">
                    <div class="filter-group">
                        <label for="seller">Filter by Seller:</label>
                        <select name="seller" id="seller">
                            <option value="">All Sellers</option>
                            {% for seller in sellers %}
                                <option value="{{ seller.id }}" {% if selected_seller|stringformat:"s" == seller.id|stringformat:"s" %}selected{% endif %}>
                                    {{ seller.username }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="status">Filter by Status:</label>
                        <select name="status" id="status">
                            <option value="">All Status</option>
                            <option value="pending" {% if selected_status == "pending" %}selected{% endif %}>Pending</option>
                            <option value="accepted" {% if selected_status == "accepted" %}selected{% endif %}>Accepted</option>
                            <option value="rejected" {% if selected_status == "rejected" %}selected{% endif %}>Rejected</option>
                            <option value="delivered" {% if selected_status == "delivered" %}selected{% endif %}>Delivered</option>
                        </select>
                    </div>
                    
                    <div class="filter-buttons">
                        <button type="submit" class="btn btn-primary">üîç Filter</button>
                        <a href="?seller=&status=" class="btn btn-secondary">‚úï Clear</a>
                    </div>
                </div>
            </form>
        </div>
        
        <!-- Commission Details Table -->
        <div class="table-section">
            {% if orders %}
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Seller Name</th>
                                <th>Fish Name</th>
                                <th>QTY (KG)</th>
                                <th>Price/Unit</th>
                                <th>Total Price</th>
                                <th>5% Commission</th>
                                <th>Seller Gets</th>
                                <th>Status</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for order in orders %}
                                <tr>
                                    <td><strong>#{{ order.id }}</strong></td>
                                    <td>{{ order.seller.username }}</td>
                                    <td>{{ order.fish.name }}</td>
                                    <td>
                                        <div>{{ order.quantity_kg }} KG</div>
                                    </td>
                                    <td>‚Çπ{{ order.fish.price|floatformat:2 }}</td>
                                    <td>
                                        <strong class="amount-positive">‚Çπ{{ order.total_price|floatformat:2 }}</strong>
                                        <div style="font-size: 11px; color: #999; margin-top: 3px;">Price/Unit: ‚Çπ{{ order.fish.price|floatformat:2 }}</div>
                                    </td>
                                    <td>
                                        <div class="amount-commission">-‚Çπ{{ order.commission_5_percent|floatformat:2 }}</div>
                                        <div class="commission-breakdown">5% of ‚Çπ{{ order.total_price|floatformat:0 }}</div>
                                    </td>
                                    <td>
                                        <strong class="amount-positive">‚Çπ{{ order.seller_amount|floatformat:2 }}</strong>
                                    </td>
                                    <td>
                                        <span class="status-badge status-{{ order.status }}">
                                            {{ order.get_status_display }}
                                        </span>
                                    </td>
                                    <td>{{ order.created_at|date:"d M Y" }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <div class="no-data">
                    <p>üìä No orders found. Try adjusting your filters.</p>
                </div>
            {% endif %}
        </div>
        
        <!-- Summary Section -->
        <div class="summary-section">
            <h2>üìà Commission Summary</h2>
            <div class="summary-row">
                <div class="summary-item">
                    <label>Total Orders Processed</label>
                    <div class="value">{{ orders|length }}</div>
                </div>
                <div class="summary-item">
                    <label>Commission Rate</label>
                    <div class="value">5%</div>
                </div>
                <div class="summary-item">
                    <label>Total Sellers Paid</label>
                    <div class="value">‚Çπ{% if orders %}{{ total_sales|add:total_commission|floatformat:2 }}{% else %}0.00{% endif %}</div>
                </div>
                <div class="summary-item">
                    <label>Platform Total Earnings</label>
                    <div class="value">‚Çπ{{ total_commission|floatformat:2 }}</div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
